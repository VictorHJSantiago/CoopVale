{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
  <h2>Editar Produto</h2>
  <form method="POST" enctype="multipart/form-data">
    <div class="mb-3">
      <label for="nome" class="form-label">Nome</label>
      <input type="text" class="form-control" id="nome" name="nome" value="{{ produto.nome }}" required>
    </div>
    <div class="mb-3">
      <label for="descricao" class="form-label">Descrição</label>
      <textarea class="form-control" id="descricao" name="descricao">{{ produto.descricao }}</textarea>
    </div>
    <div class="mb-3">
      <label for="preco" class="form-label">Preço</label>
      <input type="number" step="0.01" class="form-control" id="preco" name="preco" value="{{ produto.preco }}" required>
    </div>
    <div class="mb-3">
      <label for="unidade" class="form-label">Unidade</label>
      <input type="text" class="form-control" id="unidade" name="unidade" value="{{ produto.unidade }}" required>
    </div>
    <div class="mb-3">
      <label for="categoria_id" class="form-label">Categoria</label>
      <select class="form-select" id="categoria_id" name="categoria_id" required>
        {% for categoria in categorias %}
        <option value="{{ categoria.id }}" {% if produto.categoria_id == categoria.id %}selected{% endif %}>{{ categoria.nome }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="mb-3">
      <label for="estoque" class="form-label">Estoque</label>
      <input type="number" class="form-control" id="estoque" name="estoque" value="{{ produto.estoque }}" required>
    </div>
    <div class="mb-3">
      <label class="form-label">Imagens do Produto (até 5)</label><br>
      {% if produto.imagens %}
        <div class="mb-2">
          {% for img in produto.imagens.split(',') if img %}
            <div class="d-inline-block text-center mr-2">
              <img src="{{ url_for('static', filename=img) }}" alt="Imagem" style="max-width:80px; max-height:80px; display:block;">
              <input type="checkbox" name="remover_imagem" value="{{ img }}"> Remover
            </div>
          {% endfor %}
        </div>
      {% endif %}
      <input type="file" class="form-control" id="imagens" name="imagens" multiple accept="image/*">
    </div>
    <div class="mb-3">
      <label for="tags" class="form-label">Tags</label>
      <input type="text" class="form-control" id="tags" name="tags" value="{{ produto.tags }}">
    </div>
    <button type="submit" class="btn btn-primary">Atualizar</button>
    <a href="{{ url_for('produtos_bp.listar_produtos') }}" class="btn btn-secondary">Cancelar</a>
  </form>
</div>
{% endblock %}
